<?xml version="1.0" encoding="utf-8"?>
<vxml version="2.1"
      xmlns="http://www.w3.org/2001/vxml"
      xmlns:voxeo="http://community.voxeo.com/xmlns/vxml">

  <nomatch>
    <property name="timeout" value="3s"/>
    Sorry I didn't understand.
    <reprompt/>
  </nomatch>

  <noinput>
    <property name="timeout" value="3s"/>
    You didn't say anything.
    <reprompt/>
  </noinput>

  <!-- Data model -->
  <var name="from" />
  <var name="to" />
  <var name="date" />
  <var name="retrn" />
  <!-- HOW DO I LINK THESE UP TO THE INTERPRETATION OBJECTS??? -->
  
  <!-- State machine -->


   
  <form id="welcome">
     <block>
      <prompt bargein="false">
        <break time="1000" />
        Welcome to the flight booking service. you can go back to the main menu at any point, by saying start over or menu. let's get started.
      </prompt>
      <goto next="#journey" />
    </block>
  </form>

  <form id="journey">
    <grammar src="grammars/lab4.xml"/>
    <field name="askFrom">
      <prompt>
	Tell me about your journey
      </prompt>
      <prompt count="2">
        What city are you leaving from?
      </prompt>
      <prompt count="3">
	 you can leave from london, paris or new york.
      </prompt>
      <grammar src="grammars/lab4.xml#choosePlace"/>
    </field>
    <filled>
     <assign name="from" expr="askFrom"/> 
    </filled>

    <field name="askTo">
      <prompt>
        Where are you going?
      </prompt>
      <prompt count="2">
	 you can fly to london, paris or new york.
      </prompt>
      <grammar src="grammars/lab4.xml#choosePlace"/>
    </field>
    <filled>
      <assign name="to" expr="askTo"/>
    </filled>
    
    <field name="askDate">
      <prompt>
	What day of the week do you want to leave?
      </prompt>
      <prompt count="2">
	To choose what day you're leaving, you can say any day between monday to sunday.
      </prompt>
      <grammar src="grammars/lab4.xml#chooseDate"/>
    </field>
    <filled>
      <assign name="date" expr="askDate"/>
    </filled>

    <field name="askReturn">
       <prompt>
	  what date do you want to return?
       </prompt>
       <prompt count="2">
	 To choose what day to return, you can say any day between monday to sunday.
       </prompt>
       <grammar src="grammars/lab4.xml#chooseDate"/>
     </field>
     <filled>
       <assign name="retrn" expr="askReturn"/>
     </filled>

     <field name="askFoodField">
       <prompt>
	 what type of meal would you like to have on board the flight?
       </prompt>
       <prompt count="2">
	 To choose what type of meal you'd like, you can say chicken, fish or vegetarian.
       </prompt>
       <grammar src="grammars/lab4.xml#foodMenu"/>
     </field>

     <block>
       <prompt> 
	 do you want to go from <value expr="askFrom$.interpretation.departureCity"/> to  <value expr="askTo$.interpretation.destination"/> on <value expr="askDate$.interpretation.departureDate"/> returning <value expr="askReturn$.interpretation.returnDate"/>
       </prompt>
     </block>
   </form>

   <link next="lab1"> 
     <grammar mode="voice" version="1.0" root="root">
       <rule id="root" scope="public">
        <one-of>
          <item> start over </item>
          <item> menu </item>
        </one-of>
       </rule>
     </grammar>
   </link>

  
</vxml>
